// ==UserScript==
// @name         chatgpt Auto Mirror
// @version      2023-12-17
// @description  Auto mirror all dalle images from chatgpt
// @author       Goofables
// @match        https://chat.openai.com/*
// @icon         https://www.google.com/s2/favicons?sz=64&domain=openai.com
// ==/UserScript==

function getElementsByXPath(xpath, parent) {
    let results = [];
    let query = document.evaluate(xpath, parent || document,
        null, XPathResult.ORDERED_NODE_SNAPSHOT_TYPE, null);
    for (let i = 0, length = query.snapshotLength; i < length; ++i) {
        results.push(query.snapshotItem(i));
    }
    return results;
}

function mirror_all() {
    const images = getElementsByXPath("//img[@alt='Generated by DALLÂ·E' and contains(@src, 'files.oaiusercontent.com') and not(contains(@src, 'i.mxsmp.com'))]");
    for (const image of images) {
        image.src = "https://i.mxsmp.com/a:chatgpt/" + image.src;
    }

}


setInterval(mirror_all, 250);